### MapReduce

**MapReduce** --- —Ü–µ –º–æ–¥–µ–ª—å –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è –¥–ª—è –æ–±—Ä–æ–±–∫–∏ —Ç–∞ –≥–µ–Ω–µ—Ä—É–≤–∞–Ω–Ω—è –≤–µ–ª–∏–∫–∏—Ö –Ω–∞–±–æ—Ä—ñ–≤ –¥–∞–Ω–∏—Ö —É —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö. –í–æ–Ω–∞ –¥–æ–∑–≤–æ–ª—è—î —Ä–æ–∑–¥—ñ–ª–∏—Ç–∏ –æ–±—Ä–æ–±–∫—É –¥–∞–Ω–∏—Ö –Ω–∞ –ø–∞—Ä–∞–ª–µ–ª—å–Ω—ñ –ø—ñ–¥–∑–∞–¥–∞—á—ñ, —â–æ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –Ω–∞ –∫—ñ–ª—å–∫–æ—Ö –≤—É–∑–ª–∞—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞, —ñ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–±'—î–¥–Ω—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤ –∫—ñ–Ω—Ü–µ–≤–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

------------------------------------------------------------------------

### –ö–ª—é—á–æ–≤—ñ –æ—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ MapReduce

1.  **–ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å:**
    - –û–±—Ä–æ–±–∫–∞ —Ç–µ—Ä–∞–±–∞–π—Ç—ñ–≤ —ñ –ø–µ—Ç–∞–±–∞–π—Ç—ñ–≤ –¥–∞–Ω–∏—Ö –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–ª–∞—Å—Ç–µ—Ä—ñ–≤ —Å–µ—Ä–≤–µ—Ä—ñ–≤.
2.  **–¢–æ–ª–µ—Ä–∞–Ω—Ç–Ω—ñ—Å—Ç—å –¥–æ –∑–±–æ—ó–≤:**
    - –ê–ª–≥–æ—Ä–∏—Ç–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤–∏–∫–æ–Ω—É—î –∑–∞–≤–¥–∞–Ω–Ω—è, —è–∫—â–æ –æ–¥–∏–Ω —ñ–∑ –≤—É–∑–ª—ñ–≤ –≤–∏—Ö–æ–¥–∏—Ç—å –∑ –ª–∞–¥—É.
3.  **–ü–∞—Ä–∞–ª–µ–ª—ñ–∑–∞—Ü—ñ—è:**
    - –†–æ–∑–±–∏–≤–∞—î –æ–±—Ä–æ–±–∫—É –Ω–∞ –Ω–µ–∑–∞–ª–µ–∂–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è, —è–∫—ñ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ.
4.  **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:**
    - –ê–±—Å—Ç—Ä–∞–≥—É—î —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –∑–æ—Å–µ—Ä–µ–¥–∏—Ç–∏—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–Ω—ñ–π –ª–æ–≥—ñ—Ü—ñ.

------------------------------------------------------------------------

### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–æ–±–æ—Ç–∏ MapReduce

MapReduce —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ –¥–≤–æ—Ö –æ—Å–Ω–æ–≤–Ω–∏—Ö –µ—Ç–∞–ø—ñ–≤:

#### 1. Map (–∫–∞—Ä—Ç–∞):

- –ö–æ–∂–µ–Ω –≤—Ö—ñ–¥–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –Ω–∞ –ø–∞—Ä—É **(–∫–ª—é—á, –∑–Ω–∞—á–µ–Ω–Ω—è)**.
- –ó–∞–≤–¥–∞–Ω–Ω—è Map-—Ñ—É–Ω–∫—Ü—ñ—ó --- —Ä–æ–∑–¥—ñ–ª–∏—Ç–∏ –≤–µ–ª–∏–∫–∏–π –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö –Ω–∞ –ø—Ä–æ–º—ñ–∂–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏.

#### 2. Reduce (–∑–≤–µ–¥–µ–Ω–Ω—è):

- –ì—Ä—É–ø—É—î –ø—Ä–æ–º—ñ–∂–Ω—ñ –ø–∞—Ä–∏ **(–∫–ª—é—á, –∑–Ω–∞—á–µ–Ω–Ω—è)** –∑–∞ –∫–ª—é—á–∞–º–∏.
- –í–∏–∫–æ–Ω—É—î –æ–ø–µ—Ä–∞—Ü—ñ—ó –∞–≥—Ä–µ–≥–∞—Ü—ñ—ó, —Ç–∞–∫—ñ —è–∫ –ø—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫, —Å—É–º–∞, –º–∞–∫—Å–∏–º—É–º/–º—ñ–Ω—ñ–º—É–º —Ç–æ—â–æ, –Ω–∞–¥ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏, —â–æ –º–∞—é—Ç—å –æ–¥–Ω–∞–∫–æ–≤–∏–π –∫–ª—é—á.

------------------------------------------------------------------------

### –ê–ª–≥–æ—Ä–∏—Ç–º MapReduce (–ø–æ–∫—Ä–æ–∫–æ–≤–æ)

#### –í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ:

–†–æ–∑–±–∏—Ç—ñ –Ω–∞ —á–∞—Å—Ç–∏–Ω–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Ñ–∞–π–ª–∏ –∞–±–æ –±–ª–æ–∫–∏ –¥–∞–Ω–∏—Ö) —ñ –ø–µ—Ä–µ–¥–∞—é—Ç—å—Å—è –Ω–∞ –æ–±—Ä–æ–±–∫—É.

1.  **–†–æ–∑–±–∏—Ç—Ç—è –¥–∞–Ω–∏—Ö:**

    - –í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –¥—ñ–ª—è—Ç—å—Å—è –Ω–∞ –º–µ–Ω—à—ñ —á–∞—Å—Ç–∏–Ω–∏ (—à–º–∞—Ç–∫–∏ –∞–±–æ –±–ª–æ–∫–∏).
    - –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–µ–ª–∏–∫–∏–π —Ç–µ–∫—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª —Ä–æ–∑–¥—ñ–ª—è—î—Ç—å—Å—è –Ω–∞ –∫—ñ–ª—å–∫–∞ –º–µ–Ω—à–∏—Ö –±–ª–æ–∫—ñ–≤.

2.  **–ï—Ç–∞–ø Map:**

    - –ö–æ–∂–µ–Ω –±–ª–æ–∫ –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –Ω–∞ Map-—Ñ—É–Ω–∫—Ü—ñ—é.
    - Map-—Ñ—É–Ω–∫—Ü—ñ—è –æ–±—Ä–æ–±–ª—è—î –¥–∞–Ω—ñ —Ç–∞ –≥–µ–Ω–µ—Ä—É—î –ø—Ä–æ–º—ñ–∂–Ω—ñ –ø–∞—Ä–∏ **(–∫–ª—é—á, –∑–Ω–∞—á–µ–Ω–Ω—è)**.

3.  **–ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ (Shuffle):**

    - –ü—ñ—Å–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è Map-—Ñ—É–Ω–∫—Ü—ñ—ó –ø—Ä–æ–º—ñ–∂–Ω—ñ –ø–∞—Ä–∏ —Å–æ—Ä—Ç—É—é—Ç—å—Å—è —Ç–∞ –≥—Ä—É–ø—É—é—Ç—å—Å—è –∑–∞ –∫–ª—é—á–∞–º–∏.
    - –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –≤—Å—ñ –ø–∞—Ä–∏ –∑ –∫–ª—é—á–µ–º `word1` –≥—Ä—É–ø—É—é—Ç—å—Å—è —Ä–∞–∑–æ–º.

4.  **–ï—Ç–∞–ø Reduce:**

    - –ó–≤–µ–¥–µ–Ω–Ω—è –ø—Ä–æ–º—ñ–∂–Ω–∏—Ö –ø–∞—Ä –¥–æ –∫—ñ–Ω—Ü–µ–≤–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É.
    - –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–ª—è –∫–ª—é—á–∞ `word1` –∑–Ω–∞—á–µ–Ω–Ω—è –∞–≥—Ä–µ–≥—É—é—Ç—å—Å—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø—ñ–¥—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è —ó—Ö–Ω—è –∫—ñ–ª—å–∫—ñ—Å—Ç—å).

5.  **–†–µ–∑—É–ª—å—Ç–∞—Ç:**

    - –û—Ç—Ä–∏–º–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∑–∞–ø–∏—Å—É—é—Ç—å—Å—è —É –≤–∏—Ö—ñ–¥–Ω–∏–π —Ñ–∞–π–ª –∞–±–æ –±–∞–∑—É –¥–∞–Ω–∏—Ö.

------------------------------------------------------------------------

### –ü—Ä–∏–∫–ª–∞–¥ —Ä–æ–±–æ—Ç–∏ MapReduce

#### –ó–∞–¥–∞—á–∞: –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ —Å–ª—ñ–≤ —É —Ç–µ–∫—Å—Ç—ñ

**–í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ:**

    file1: "hello world"
    file2: "hello mapreduce"

#### –ï—Ç–∞–ø Map:

- Map-—Ñ—É–Ω–∫—Ü—ñ—è –æ—Ç—Ä–∏–º—É—î —Ä—è–¥–∫–∏ —Ç–µ–∫—Å—Ç—É —ñ –≥–µ–Ω–µ—Ä—É—î –ø–∞—Ä–∏ **(—Å–ª–æ–≤–æ, 1)**.

**–†–µ–∑—É–ª—å—Ç–∞—Ç Map:**

    (hello, 1), (world, 1), (hello, 1), (mapreduce, 1)

#### –ï—Ç–∞–ø Shuffle:

- –ì—Ä—É–ø—É–≤–∞–Ω–Ω—è –ø–∞—Ä –∑–∞ –∫–ª—é—á–∞–º–∏.

**–†–µ–∑—É–ª—å—Ç–∞—Ç Shuffle:**

    (hello, [1, 1]), (world, [1]), (mapreduce, [1])

#### –ï—Ç–∞–ø Reduce:

- Reduce-—Ñ—É–Ω–∫—Ü—ñ—è –ø—ñ–¥—Å—É–º–æ–≤—É—î –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫–ª—é—á–∞.

**–†–µ–∑—É–ª—å—Ç–∞—Ç Reduce:**

    (hello, 2), (world, 1), (mapreduce, 1)

------------------------------------------------------------------------

### –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –Ω–∞ Python

``` python
from collections import defaultdict

# Map step
def map_function(data):
    result = []
    for line in data:
        for word in line.split():
            result.append((word, 1))  # –§–æ—Ä–º—É—î–º–æ –ø–∞—Ä–∏ (—Å–ª–æ–≤–æ, 1)
    return result

# Shuffle and sort
def shuffle_and_sort(mapped_data):
    grouped_data = defaultdict(list)
    for key, value in mapped_data:
        grouped_data[key].append(value)  # –ì—Ä—É–ø—É—î–º–æ –∑–∞ –∫–ª—é—á–∞–º–∏
    return grouped_data

# Reduce step
def reduce_function(grouped_data):
    reduced_data = {}
    for key, values in grouped_data.items():
        reduced_data[key] = sum(values)  # –ê–≥—Ä–µ–≥–∞—Ü—ñ—è
    return reduced_data

# Input data
data = [
    "hello world",
    "hello mapreduce"
]

# Execute MapReduce
mapped_data = map_function(data)
grouped_data = shuffle_and_sort(mapped_data)
result = reduce_function(grouped_data)

print(result)  # –í–∏—Ö—ñ–¥: {'hello': 2, 'world': 1, 'mapreduce': 1}
```

------------------------------------------------------------------------

### –ü–µ—Ä–µ–≤–∞–≥–∏ MapReduce

1.  **–ü—Ä–æ—Å—Ç–æ—Ç–∞:**
    - –ê–±—Å—Ç—Ä–∞–≥—É—î —Å–∫–ª–∞–¥–Ω–æ—â—ñ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å.
2.  **–ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å:**
    - –õ–µ–≥–∫–æ –º–∞—Å—à—Ç–∞–±—É—î—Ç—å—Å—è –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –≤–µ–ª–∏–∫–∏—Ö –æ–±—Å—è–≥—ñ–≤ –¥–∞–Ω–∏—Ö –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä—ñ.
3.  **–¢–æ–ª–µ—Ä–∞–Ω—Ç–Ω—ñ—Å—Ç—å –¥–æ –∑–±–æ—ó–≤:**
    - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤—ñ–¥–Ω–æ–≤–ª—é—î –∑–∞–≤–¥–∞–Ω–Ω—è —É —Ä–∞–∑—ñ –ø–æ–º–∏–ª–æ–∫.

------------------------------------------------------------------------

### –ù–µ–¥–æ–ª—ñ–∫–∏ MapReduce

1.  **–í–∏—Å–æ–∫—ñ –∑–∞—Ç—Ä–∏–º–∫–∏:**
    - –ö–æ–∂–µ–Ω –µ—Ç–∞–ø –æ–±—Ä–æ–±–∫–∏ (Map, Shuffle, Reduce) –º–æ–∂–µ –∑–∞–π–º–∞—Ç–∏ –±–∞–≥–∞—Ç–æ —á–∞—Å—É.
2.  **–û–±–º–µ–∂–µ–Ω–Ω—è –≤ –≥–Ω—É—á–∫–æ—Å—Ç—ñ:**
    - –ù–µ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è –≤—Å—ñ—Ö –∑–∞–¥–∞—á, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Ç–∏—Ö, —â–æ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å —ñ—Ç–µ—Ä–∞—Ü—ñ–π.
3.  **–ù–∞–¥–º—ñ—Ä–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó –∑–∞–ø–∏—Å—É/—á–∏—Ç–∞–Ω–Ω—è:**
    - –î–∞–Ω—ñ —á–∞—Å—Ç–æ –∑–∞–ø–∏—Å—É—é—Ç—å—Å—è –Ω–∞ –¥–∏—Å–∫ –º—ñ–∂ –µ—Ç–∞–ø–∞–º–∏, —â–æ –∑–Ω–∏–∂—É—î –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å.

------------------------------------------------------------------------

### –ó–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è MapReduce

1.  **–ü–æ—à—É–∫–æ–≤—ñ —Å–∏—Å—Ç–µ–º–∏:**

    - –ê–Ω–∞–ª—ñ–∑ –≤–µ–±-–ª–æ–≥—ñ–≤.
    - –Ü–Ω–¥–µ–∫—Å—É–≤–∞–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–æ–∫.

2.  **Big Data –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞:**

    - –û–±—Ä–æ–±–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π.
    - –ê–Ω–∞–ª—ñ–∑ –∫–ª—ñ—î–Ω—Ç—Å—å–∫–æ—ó –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ.

3.  **–ú–∞—à–∏–Ω–Ω–µ –Ω–∞–≤—á–∞–Ω–Ω—è:**

    - –ü–æ–ø–µ—Ä–µ–¥–Ω—è –æ–±—Ä–æ–±–∫–∞ –≤–µ–ª–∏–∫–∏—Ö –Ω–∞–±–æ—Ä—ñ–≤ –¥–∞–Ω–∏—Ö.

4.  **–ì–µ–Ω–æ–º—ñ–∫–∞:**

    - –ê–Ω–∞–ª—ñ–∑ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç–µ–π –î–ù–ö.

------------------------------------------------------------------------

### –í–∏—Å–Ω–æ–≤–æ–∫

MapReduce —î –ø–æ—Ç—É–∂–Ω–∏–º —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –≤–µ–ª–∏–∫–∏–º–∏ –¥–∞–Ω–∏–º–∏, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å —ñ —Ç–æ–ª–µ—Ä–∞–Ω—Ç–Ω—ñ—Å—Ç—å –¥–æ –∑–±–æ—ó–≤. –¶–µ —ñ–¥–µ–∞–ª—å–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥ –¥–ª—è –±–∞–≥–∞—Ç—å–æ—Ö –∑–∞–¥–∞—á, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ —Ä–æ–∑–¥—ñ–ª–µ–Ω—ñ –Ω–∞ –Ω–µ–∑–∞–ª–µ–∂–Ω—ñ –ø—ñ–¥–∑–∞–¥–∞—á—ñ, —ñ –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –æ—Å–Ω–æ–≤–æ—é —Å—É—á–∞—Å–Ω–∏—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π –æ–±—Ä–æ–±–∫–∏ –¥–∞–Ω–∏—Ö, —Ç–∞–∫–∏—Ö —è–∫ Hadoop —ñ Spark.

------------------------------------------------------------------------

### –§—É–Ω–∫—Ü—ñ—ó `map` —Ç–∞ `reduce` –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ MapReduce

------------------------------------------------------------------------

#### `map` (–∫–∞—Ä—Ç–∞)

- –§—É–Ω–∫—Ü—ñ—è `map` –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ —É –ø–∞—Ä–∏ **(–∫–ª—é—á, –∑–Ω–∞—á–µ–Ω–Ω—è)** –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ—ó –æ–±—Ä–æ–±–∫–∏.
- –¶–µ –ø–µ—Ä—à–∏–π –µ—Ç–∞–ø –æ–±—Ä–æ–±–∫–∏ –≤ MapReduce, –¥–µ –¥–∞–Ω—ñ —Ä–æ–∑–±–∏–≤–∞—é—Ç—å—Å—è –Ω–∞ –º–µ–Ω—à—ñ —á–∞—Å—Ç–∏–Ω–∏ —ñ –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è –Ω–µ–∑–∞–ª–µ–∂–Ω–æ.
- **–ó–∞–¥–∞—á–∞:** –†–æ–∑–¥—ñ–ª–∏—Ç–∏ –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ —Ç–∞–∫, —â–æ–± —ó—Ö –±—É–ª–æ –ª–µ–≥–∫–æ –∞–≥—Ä–µ–≥—É–≤–∞—Ç–∏ –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É –µ—Ç–∞–ø—ñ.

##### –ü—Ä–∏–∫–ª–∞–¥: –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ —Å–ª—ñ–≤

–í—Ö—ñ–¥–Ω–∏–π —Ç–µ–∫—Å—Ç:

    "hello world hello mapreduce"

–†–µ–∑—É–ª—å—Ç–∞—Ç `map`:

    [("hello", 1), ("world", 1), ("hello", 1), ("mapreduce", 1)]

------------------------------------------------------------------------

#### `reduce` (–∑–≤–µ–¥–µ–Ω–Ω—è)

- –§—É–Ω–∫—Ü—ñ—è `reduce` –∞–≥—Ä–µ–≥—É—î –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –æ–¥–Ω–∞–∫–æ–≤–∏—Ö –∫–ª—é—á—ñ–≤, –æ—Ç—Ä–∏–º–∞–Ω–∏—Ö —ñ–∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –µ—Ç–∞–ø—É.
- –í–æ–Ω–∞ –ø—Ä–∞—Ü—é—î –∑ –≥—Ä—É–ø–∞–º–∏ –¥–∞–Ω–∏—Ö, —è–∫—ñ –º–∞—é—Ç—å –æ–¥–Ω–∞–∫–æ–≤—ñ –∫–ª—é—á—ñ, —ñ –æ–±—á–∏—Å–ª—é—î –ø—ñ–¥—Å—É–º–∫–æ–≤–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (—Å—É–º–∞, –º–∞–∫—Å–∏–º—É–º, —Å–µ—Ä–µ–¥–Ω—î —Ç–æ—â–æ).

##### –ü—Ä–∏–∫–ª–∞–¥: –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ —Å–ª—ñ–≤

–í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ (–ø—ñ—Å–ª—è `map`):

    [("hello", [1, 1]), ("world", [1]), ("mapreduce", [1])]

–†–µ–∑—É–ª—å—Ç–∞—Ç `reduce`:

    [("hello", 2), ("world", 1), ("mapreduce", 1)]

------------------------------------------------------------------------

### –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –±–∞–∑–æ–≤–æ—ó –≤–µ—Ä—Å—ñ—ó MapReduce

#### –ü—Ä–∏–∫–ª–∞–¥: –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É —Å–ª—ñ–≤ –≤—Ä—É—á–Ω—É

``` python
from collections import defaultdict

# –§—É–Ω–∫—Ü—ñ—è map
def map_function(data):
    result = []
    for line in data:
        for word in line.split():
            result.append((word, 1))
    return result

# –§—É–Ω–∫—Ü—ñ—è shuffle (–≥—Ä—É–ø—É–≤–∞–Ω–Ω—è)
def shuffle(mapped_data):
    grouped_data = defaultdict(list)
    for key, value in mapped_data:
        grouped_data[key].append(value)
    return grouped_data

# –§—É–Ω–∫—Ü—ñ—è reduce
def reduce_function(grouped_data):
    reduced_data = {}
    for key, values in grouped_data.items():
        reduced_data[key] = sum(values)
    return reduced_data

# –í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ
data = [
    "hello world",
    "hello mapreduce"
]

# –í–∏–∫–æ–Ω–∞–Ω–Ω—è MapReduce
mapped_data = map_function(data)
grouped_data = shuffle(mapped_data)
result = reduce_function(grouped_data)

print(result)  # {'hello': 2, 'world': 1, 'mapreduce': 1}
```

------------------------------------------------------------------------

#### –ü—Ä–∏–∫–ª–∞–¥: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è PySpark

``` python
from pyspark import SparkContext

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è SparkContext
sc = SparkContext("local", "Word Count")

# –í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ
data = ["hello world", "hello mapreduce"]

# –í–∏–∫–æ–Ω–∞–Ω–Ω—è MapReduce
rdd = sc.parallelize(data)
result = (rdd.flatMap(lambda line: line.split())  # Map: –†–æ–∑–±–∏–≤–∞—î–º–æ —Ä—è–¥–∫–∏ –Ω–∞ —Å–ª–æ–≤–∞
            .map(lambda word: (word, 1))         # –ì–µ–Ω–µ—Ä—É—î–º–æ –ø–∞—Ä–∏ (—Å–ª–æ–≤–æ, 1)
            .reduceByKey(lambda a, b: a + b))    # Reduce: –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫
print(result.collect())  # [('hello', 2), ('world', 1), ('mapreduce', 1)]
```

------------------------------------------------------------------------

### –ü–∞—Ä–∞–ª–µ–ª—å–Ω—ñ—Å—Ç—å —É MapReduce

#### 1. –†–æ–∑–±–∏—Ç—Ç—è –∑–∞–¥–∞—á—ñ –Ω–∞ –ø—ñ–¥–∑–∞–¥–∞—á—ñ

- –í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ —Ä–æ–∑–±–∏–≤–∞—é—Ç—å—Å—è –Ω–∞ –±–ª–æ–∫–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Ç–µ–∫—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª –Ω–∞ –∫—ñ–ª—å–∫–∞ —á–∞—Å—Ç–∏–Ω).
- –ö–æ–∂–Ω–∞ —á–∞—Å—Ç–∏–Ω–∞ –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è –æ–∫—Ä–µ–º–æ—é —Ñ—É–Ω–∫—Ü—ñ—î—é `map` –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö –≤—É–∑–ª–∞—Ö.

#### 2. –ë–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

- –î–∞–Ω—ñ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–æ–∑–ø–æ–¥—ñ–ª—è—é—Ç—å—Å—è –º—ñ–∂ –≤—É–∑–ª–∞–º–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞.
- –Ø–∫—â–æ –æ–¥–∏–Ω –≤—É–∑–æ–ª –∑–∞–π–Ω—è—Ç–∏–π –∞–±–æ –≤–∏—Ö–æ–¥–∏—Ç—å –∑ –ª–∞–¥—É, –π–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è —ñ–Ω—à–æ–º—É –≤—É–∑–ª—É.

#### 3. –õ–æ–∫–∞–ª—å–Ω—ñ—Å—Ç—å –¥–∞–Ω–∏—Ö

- MapReduce –≤–∏–∫–æ–Ω—É—î –æ–±—Ä–æ–±–∫—É –¥–∞–Ω–∏—Ö —è–∫–æ–º–æ–≥–∞ –±–ª–∏–∂—á–µ –¥–æ –º—ñ—Å—Ü—è —ó—Ö–Ω—å–æ–≥–æ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –Ω–∞ —Ç–æ–º—É –∂ —Å–µ—Ä–≤–µ—Ä—ñ –∞–±–æ –∂–æ—Ä—Å—Ç–∫–æ–º—É –¥–∏—Å–∫—É), —â–æ–± –º—ñ–Ω—ñ–º—ñ–∑—É–≤–∞—Ç–∏ –≤–∏—Ç—Ä–∞—Ç–∏ –Ω–∞ –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–∏—Ö.

------------------------------------------------------------------------

### –ü—Ä–∞–∫—Ç–∏—á–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥: –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ —É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π

#### –ó–∞–¥–∞—á–∞:

–û–±—á–∏—Å–ª–∏—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —É –≤–µ–ª–∏–∫–æ–º—É –Ω–∞–±–æ—Ä—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π.

–í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ:

    user_id, amount
    1, 100
    2, 200
    1, 150
    3, 300
    2, 250

#### –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è MapReduce

``` python
# –§—É–Ω–∫—Ü—ñ—è map
def map_transactions(data):
    return [(line.split(",")[0], 1) for line in data]  # –í–∏—Ç—è–≥—É—î–º–æ user_id

# –§—É–Ω–∫—Ü—ñ—è shuffle
def shuffle(mapped_data):
    grouped_data = defaultdict(list)
    for key, value in mapped_data:
        grouped_data[key].append(value)
    return grouped_data

# –§—É–Ω–∫—Ü—ñ—è reduce
def reduce_transactions(grouped_data):
    return {key: 1 for key in grouped_data.keys()}  # –£–Ω—ñ–∫–∞–ª—å–Ω—ñ user_id

# –í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ
transactions = [
    "1,100",
    "2,200",
    "1,150",
    "3,300",
    "2,250"
]

# –í–∏–∫–æ–Ω–∞–Ω–Ω—è MapReduce
mapped_data = map_transactions(transactions)
grouped_data = shuffle(mapped_data)
unique_users = reduce_transactions(grouped_data)

print(f"–ö—ñ–ª—å–∫—ñ—Å—Ç—å —É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤: {len(unique_users)}")  # 3
```

------------------------------------------------------------------------

### **–í–∏—Å–Ω–æ–≤–æ–∫**

MapReduce –∑–∞–±–µ–∑–ø–µ—á—É—î –µ—Ñ–µ–∫—Ç–∏–≤–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –¥–≤–∞ –ø—Ä–æ—Å—Ç–∏—Ö –µ—Ç–∞–ø–∏: `map` —ñ `reduce`. –¶–µ–π –ø—ñ–¥—Ö—ñ–¥ —à–∏—Ä–æ–∫–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö –∑–∞–≤–¥—è–∫–∏ –π–æ–≥–æ –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω–æ—Å—Ç—ñ, –Ω–∞–¥—ñ–π–Ω–æ—Å—Ç—ñ —Ç–∞ –ø—Ä–æ—Å—Ç–æ—Ç—ñ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó. –ù–∞–≤–µ–¥–µ–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—é—Ç—å –π–æ–≥–æ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å –Ω–∞–≤—ñ—Ç—å —É –ø—Ä–æ—Å—Ç–∏—Ö –∑–∞–¥–∞—á–∞—Ö, —Ç–∞–∫–∏—Ö —è–∫ –ø—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ —Å–ª—ñ–≤ –∞–±–æ –∞–Ω–∞–ª—ñ–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π.

## Trade-offs

### Advantages üëç

1.  **Simplicity**
    - Abstract parallel computing
    - Focus on business logic
2.  **Scalability**
    - Easy cluster scaling
    - Automatic load distribution
3.  **Fault Tolerance**
    - Automatic recovery
    - Task replication

### Disadvantages üëé

1.  **Latency**
    - Processing stage delays
    - I/O overhead
2.  **Flexibility Limitations**
    - Not ideal for iterative tasks
    - Sequential dependency issues
3.  **I/O Intensive**
    - Disk operations between stages
    - Network transfer overhead

## Related Topics

- [Hadoop Ecosystem](Hadoop Ecosystem "wikilink")
- [Distributed Computing](Distributed Computing "wikilink")
- [Big Data Processing](Big Data Processing "wikilink")
- [Parallel Algorithms](Parallel Algorithms "wikilink")
- [Data Processing Frameworks](Data Processing Frameworks "wikilink")

## Additional Resources

- üìö [MapReduce Patterns](MapReduce Patterns "wikilink")
- üîß [Implementation Guides](Implementation Guides "wikilink")
- üìä [Performance Analysis](Performance Analysis "wikilink")
- üéì [Learning Resources](Learning Resources "wikilink")

\#big-data/frameworks \#distributed-computing \#parallel-processing \#data-processing \#programming/distributed-systems \#hadoop/mapreduce

------------------------------------------------------------------------

# Blended

## –î–µ—Ç–∞–ª—å–Ω–µ –∑–∞–Ω—è—Ç—Ç—è –Ω–∞ —Ç–µ–º—É "MapReduce"

\#distributed-systems \#big-data \#mapreduce \#hadoop \#parallel-computing \#data-processing

## –¶—ñ–ª—å –∑–∞–Ω—è—Ç—Ç—è

- –û–∑–Ω–∞–π–æ–º–∏—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –∑ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—î—é —Ç–∞ –º–æ–¥–µ–ª–ª—é –æ–±—á–∏—Å–ª–µ–Ω—å MapReduce
- –ù–∞–≤—á–∏—Ç–∏ —Ä–µ–∞–ª—ñ–∑–æ–≤—É–≤–∞—Ç–∏ –±–∞–∑–æ–≤—ñ –∑–∞–¥–∞—á—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é MapReduce
- –ü–æ—è—Å–Ω–∏—Ç–∏, —è–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ MapReduce —É —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö (–Ω–∞ –ø—Ä–∏–∫–ª–∞–¥—ñ Hadoop —á–∏ –∞–Ω–∞–ª–æ–≥—ñ–≤)
- –†–æ–∑—à–∏—Ä–∏—Ç–∏ –∑–Ω–∞–Ω–Ω—è —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –ø—Ä–æ –ø–∞—Ä–∞–ª–µ–ª—å–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è —Ç–∞ –æ–±—Ä–æ–±–∫—É –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö

## –ü–ª–∞–Ω –∑–∞–Ω—è—Ç—Ç—è

### 1. –¢–µ–æ—Ä–µ—Ç–∏—á–Ω–∏–π –±–ª–æ–∫ (20 —Ö–≤–∏–ª–∏–Ω)

#### 1.1 –©–æ —Ç–∞–∫–µ MapReduce?

- **–ú–æ–¥–µ–ª—å –æ–±—á–∏—Å–ª–µ–Ω—å** –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –≤–µ–ª–∏–∫–∏—Ö –æ–±—Å—è–≥—ñ–≤ –¥–∞–Ω–∏—Ö —É —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö
- **–†–æ–∑–¥—ñ–ª–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ –Ω–∞ –¥–≤—ñ –æ—Å–Ω–æ–≤–Ω—ñ —Å—Ç–∞–¥—ñ—ó:**
  - **Map:** –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ —É —Ñ–æ—Ä–º—É "–∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è"
  - **Reduce:** –ê–≥—Ä–µ–≥—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∑ –æ–¥–Ω–∞–∫–æ–≤–∏–º–∏ –∫–ª—é—á–∞–º–∏

#### 1.2 –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ —Ç–∞ —Ä–æ–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å

- –î–∞–Ω—ñ —Ä–æ–∑–±–∏–≤–∞—é—Ç—å—Å—è –Ω–∞ **—á–∞—Å—Ç–∏–Ω–∏** (shards)
- **–ú–∞–ø–ø–µ—Ä–∏** –æ–±—Ä–æ–±–ª—è—é—Ç—å –∫–æ–∂–Ω—É —á–∞—Å—Ç–∏–Ω—É –Ω–µ–∑–∞–ª–µ–∂–Ω–æ
- **–®–∞—Ñ–ª (shuffle):** –†–æ–∑–ø–æ–¥—ñ–ª –¥–∞–Ω–∏—Ö –∑–∞ –∫–ª—é—á–∞–º–∏ –¥–ª—è —Ä–µ–¥—å—é—Å–µ—Ä—ñ–≤
- **–†–µ–¥—å—é—Å–µ—Ä–∏:** –û–±—á–∏—Å–ª—é—é—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫–ª—é—á–∞

#### 1.3 –ü—Ä–∏–∫–ª–∞–¥–∏ —Ä–µ–∞–ª—å–Ω–∏—Ö –∑–∞–¥–∞—á

- –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ —á–∞—Å—Ç–æ—Ç–∏ —Å–ª—ñ–≤ —É —Ç–µ–∫—Å—Ç–æ–≤–∏—Ö —Ñ–∞–π–ª–∞—Ö
- –û–±—Ä–æ–±–∫–∞ –≤–µ–±-–ª–æ–≥—ñ–≤ (–ø—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ —É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö IP)
- –°—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö

#### 1.4 –ö–ª—é—á–æ–≤—ñ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—ó

- –ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å: –æ–±—Ä–æ–±–∫–∞ –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä—ñ –º–∞—à–∏–Ω
- –¢–æ–ª–µ—Ä–∞–Ω—Ç–Ω—ñ—Å—Ç—å –¥–æ –≤—ñ–¥–º–æ–≤: –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞–¥–∞—á —É –≤–∏–ø–∞–¥–∫—É –ø–æ–º–∏–ª–æ–∫
- –í–∞–∂–ª–∏–≤—ñ—Å—Ç—å —ñ–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—ñ –∫–ª—é—á—ñ–≤ —É —Ñ–∞–∑—ñ "Shuffle and Sort"

#### 1.5 –û–±–º–µ–∂–µ–Ω–Ω—è

- –ù–µ –∑–∞–≤–∂–¥–∏ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è –∑–∞–¥–∞—á —ñ–∑ —Å–∫–ª–∞–¥–Ω–∏–º–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—è–º–∏ –º—ñ–∂ –¥–∞–Ω–∏–º–∏
- –í–∏—Å–æ–∫—ñ –Ω–∞–∫–ª–∞–¥–Ω—ñ –≤–∏—Ç—Ä–∞—Ç–∏ –Ω–∞ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—é –º—ñ–∂ –≤—É–∑–ª–∞–º–∏

#### –ó–∞–ø–∏—Ç–∞–Ω–Ω—è –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤

- –ß–æ–º—É –æ–±—Ä–æ–±–∫–∞ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è —î –≤–∞–∂–ª–∏–≤–æ—é –¥–ª—è —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏—Ö —Å–∏—Å—Ç–µ–º?
- –Ø–∫ "shuffle and sort" –≤–ø–ª–∏–≤–∞—î –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å MapReduce?

### 2. –ü—Ä–∞–∫—Ç–∏—á–Ω–∏–π –±–ª–æ–∫ (70 —Ö–≤–∏–ª–∏–Ω)

#### 2.1 –ë–∞–∑–æ–≤–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è MapReduce (30 —Ö–≤–∏–ª–∏–Ω)

**–ó–∞–≤–¥–∞–Ω–Ω—è:** –ù–∞–ø–∏—Å–∞—Ç–∏ –∫–æ–¥ –¥–ª—è –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É —á–∞—Å—Ç–æ—Ç–∏ —Å–ª—ñ–≤ —É —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É —Ñ–∞–π–ª—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é MapReduce.

``` python
from collections import defaultdict

# Map function
def map_function(lines):
    intermediate = []
    for line in lines:
        words = line.strip().split()
        for word in words:
            intermediate.append((word, 1))
    return intermediate

# Reduce function
def reduce_function(intermediate):
    result = defaultdict(int)
    for key, value in intermediate:
        result[key] += value
    return result

# –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è
lines = [
    "big data is amazing",
    "big data needs tools like MapReduce",
    "data processing is key"
]

# Map phase
mapped = map_function(lines)

# Shuffle and Reduce phase
reduced = reduce_function(mapped)

# –í–∏–≤–µ–¥–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
print("–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É —á–∞—Å—Ç–æ—Ç–∏ —Å–ª—ñ–≤:")
for word, count in reduced.items():
    print(f"{word}: {count}")
```

**–ó–∞–ø–∏—Ç–∞–Ω–Ω—è –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤:**
- –Ø–∫ –æ–±'—î–¥–Ω–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –∑ –∫—ñ–ª—å–∫–æ—Ö –º–∞—à–∏–Ω?
- –Ø–∫ –æ–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏ –æ–±—Ä–æ–±–∫—É –≤–µ–ª–∏–∫–∏—Ö —Ñ–∞–π–ª—ñ–≤?

#### 2.2 –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è MapReduce –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º —Ä–µ–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö (20 —Ö–≤–∏–ª–∏–Ω)

**–ó–∞–≤–¥–∞–Ω–Ω—è:** –û–±—Ä–æ–±–∏—Ç–∏ –≤–µ–±-–ª–æ–≥–∏ –¥–ª—è –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∑–∞–ø–∏—Ç—ñ–≤ –≤—ñ–¥ –∫–æ–∂–Ω–æ–≥–æ IP-–∞–¥—Ä–µ—Å—É.

``` python
def map_logs(logs):
    intermediate = []
    for log in logs:
        ip = log.split()[0]
        intermediate.append((ip, 1))
    return intermediate

def reduce_logs(intermediate):
    result = defaultdict(int)
    for ip, count in intermediate:
        result[ip] += count
    return result

# –õ–æ–≥–∏ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
logs = [
    "192.168.1.1 GET /index.html",
    "192.168.1.2 POST /login",
    "192.168.1.1 GET /about",
    "192.168.1.3 GET /index.html",
    "192.168.1.1 POST /logout"
]

mapped_logs = map_logs(logs)
reduced_logs = reduce_logs(mapped_logs)

print("–ö—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Ç—ñ–≤ –∑–∞ IP:")
for ip, count in reduced_logs.items():
    print(f"{ip}: {count}")
```

**–ó–∞–ø–∏—Ç–∞–Ω–Ω—è –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤:**
- –Ø–∫ –º–æ–∂–Ω–∞ –∑–º—ñ–Ω–∏—Ç–∏ —Ñ–æ—Ä–º–∞—Ç –ª–æ–≥—ñ–≤, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –±—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó?
- –Ø–∫ –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü—å–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º—É?

#### 2.3 –†–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –∑ Hadoop (20 —Ö–≤–∏–ª–∏–Ω)

**–ó–∞–≤–¥–∞–Ω–Ω—è:** –†–æ–∑—ñ–±—Ä–∞—Ç–∏ —Ä–æ–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å MapReduce —É Hadoop —á–µ—Ä–µ–∑ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

``` python
# –Ü–º—ñ—Ç–∞—Ü—ñ—è Hadoop —á–µ—Ä–µ–∑ Python
from multiprocessing import Pool

def parallel_map(mapper, chunks):
    with Pool(len(chunks)) as pool:
        return pool.map(mapper, chunks)

def parallel_reduce(reducer, mapped_chunks):
    combined = []
    for chunk in mapped_chunks:
        combined.extend(chunk)
    return reducer(combined)

lines = [
    "big data is amazing",
    "big data needs tools like MapReduce",
    "data processing is key"
]

# –ü–æ–¥—ñ–ª –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö –Ω–∞ —à–º–∞—Ç–∫–∏
chunks = [lines[:2], lines[2:]]

# –í–∏–∫–æ–Ω–∞–Ω–Ω—è MapReduce —É –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ–º—É —Ä–µ–∂–∏–º—ñ
mapped_chunks = parallel_map(map_function, chunks)
result = parallel_reduce(reduce_function, mapped_chunks)

print("–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ–≥–æ MapReduce:")
for word, count in result.items():
    print(f"{word}: {count}")
```

**–ó–∞–ø–∏—Ç–∞–Ω–Ω—è –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤:**
- –Ø–∫ Hadoop –æ–±—Ä–æ–±–ª—è—î –Ω–µ–≤–¥–∞–ª—ñ –∑–∞–¥–∞—á—ñ (failover)?
- –Ø–∫—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è Hadoop –ø–æ—Ä—ñ–≤–Ω—è–Ω–æ –∑ —Å—É—á–∞—Å–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Apache Spark)?

### 3. –†–µ—Ñ–ª–µ–∫—Å—ñ—è —Ç–∞ –æ–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è (10 —Ö–≤–∏–ª–∏–Ω)

1.  –Ø–∫—ñ —Ç–∏–ø–∏ –∑–∞–¥–∞—á –¥–æ–±—Ä–µ –ø—ñ–¥—Ö–æ–¥—è—Ç—å –¥–ª—è –º–æ–¥–µ–ª—ñ MapReduce?
2.  –Ø–∫ –º–æ–∂–Ω–∞ –ø–æ–∫—Ä–∞—â–∏—Ç–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å "shuffle and sort"?
3.  –Ø–∫ —Ü—è –º–æ–¥–µ–ª—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —É —Å—É—á–∞—Å–Ω–∏—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Spark, Flink)?

## –°–ø–∏—Å–æ–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∏—Ö –∫–æ–Ω—Ü–µ–ø—Ü—ñ–π/—Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π/—Ç–µ–º –¥–ª—è –¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è

\#related-topics
- **Hadoop:** –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ —ñ —Ä–æ–±–æ—Ç–∞ –∑ HDFS (Hadoop Distributed File System)
- **–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è:** MapReduce vs Spark (–ø–µ—Ä–µ–≤–∞–≥–∏ —Ç–∞ –Ω–µ–¥–æ–ª—ñ–∫–∏ –∫–æ–∂–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏)
- **–ü–∞—Ä–∞–ª–µ–ª—å–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è:** –ü—Ä–∏–Ω—Ü–∏–ø–∏ —Ç–∞ –≤–∏–∫–ª–∏–∫–∏
- **Apache Beam:** –£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∞ –º–æ–¥–µ–ª—å –æ–±—Ä–æ–±–∫–∏ –¥–∞–Ω–∏—Ö, —Å—É–º—ñ—Å–Ω–∞ –∑ MapReduce
- **Batch vs Stream Processing:** –Ø–∫ –º–æ–¥–µ–ª—ñ –æ–±—á–∏—Å–ª–µ–Ω—å –≤—ñ–¥—Ä—ñ–∑–Ω—è—é—Ç—å—Å—è —É —Ä—ñ–∑–Ω–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—è—Ö

## –î–æ–º–∞—à–Ω—î –∑–∞–≤–¥–∞–Ω–Ω—è

### 1. –¢–µ–æ—Ä–µ—Ç–∏—á–Ω–µ –ø–∏—Ç–∞–Ω–Ω—è

- –î–æ–≤–µ–¥—ñ—Ç—å, —á–æ–º—É MapReduce –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω–æ –Ω–∞–≤—ñ—Ç—å –¥–ª—è –º—ñ–ª—å—è—Ä–¥—ñ–≤ –∑–∞–ø–∏—Å—ñ–≤
- –Ø–∫ "combiner" –º–æ–∂–µ –∑–º–µ–Ω—à–∏—Ç–∏ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ —Ä–µ–¥—å—é—Å–µ—Ä–∏?

### 2. –ü—Ä–∞–∫—Ç–∏—á–Ω–µ –∑–∞–≤–¥–∞–Ω–Ω—è

- –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ MapReduce –¥–ª—è –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—ñ –ø—Ä–æ–¥—É–∫—Ç—ñ–≤ —É –¥–∞–Ω–∏—Ö –ø—Ä–æ–¥–∞–∂—ñ–≤ (—Ñ–æ—Ä–º–∞—Ç: `product_id, quantity`)
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ Hadoop (–∞–±–æ PySpark) –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –≤–µ–ª–∏–∫–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤–∏—Ö —Ñ–∞–π–ª—ñ–≤

\#homework \#practice \#theory

# Questions

## List

**–¢–µ–æ—Ä–µ—Ç–∏—á–Ω–∏–π –±–ª–æ–∫:**

- –ß–æ–º—É –æ–±—Ä–æ–±–∫–∞ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è —î –≤–∞–∂–ª–∏–≤–æ—é –¥–ª—è —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏—Ö —Å–∏—Å—Ç–µ–º?
- –Ø–∫ "shuffle and sort" –≤–ø–ª–∏–≤–∞—î –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å MapReduce?

**–ü—Ä–∞–∫—Ç–∏—á–Ω–∏–π –±–ª–æ–∫ (–ó–∞–ø–∏—Ç–∞–Ω–Ω—è –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –¥–æ –ø–µ—Ä—à–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è):**

- –Ø–∫ –æ–±'—î–¥–Ω–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –∑ –∫—ñ–ª—å–∫–æ—Ö –º–∞—à–∏–Ω?
- –Ø–∫ –æ–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏ –æ–±—Ä–æ–±–∫—É –≤–µ–ª–∏–∫–∏—Ö —Ñ–∞–π–ª—ñ–≤?

**–ü—Ä–∞–∫—Ç–∏—á–Ω–∏–π –±–ª–æ–∫ (–ó–∞–ø–∏—Ç–∞–Ω–Ω—è –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –¥–æ –¥—Ä—É–≥–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è):**

- –Ø–∫ –º–æ–∂–Ω–∞ –∑–º—ñ–Ω–∏—Ç–∏ —Ñ–æ—Ä–º–∞—Ç –ª–æ–≥—ñ–≤, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –±—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó?
- –Ø–∫ –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü—å–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º—É?

**–ü—Ä–∞–∫—Ç–∏—á–Ω–∏–π –±–ª–æ–∫ (–ó–∞–ø–∏—Ç–∞–Ω–Ω—è –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –¥–æ —Ç—Ä–µ—Ç—å–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è):**

- –Ø–∫ Hadoop –æ–±—Ä–æ–±–ª—è—î –Ω–µ–≤–¥–∞–ª—ñ –∑–∞–¥–∞—á—ñ (failover)?
- –Ø–∫—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è Hadoop –ø–æ—Ä—ñ–≤–Ω—è–Ω–æ –∑ —Å—É—á–∞—Å–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Apache Spark)?

**–†–µ—Ñ–ª–µ–∫—Å—ñ—è —Ç–∞ –æ–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è (–ø—ñ—Å–ª—è –ø—Ä–∞–∫—Ç–∏—á–Ω–æ–≥–æ –±–ª–æ–∫—É):**

- –Ø–∫—ñ —Ç–∏–ø–∏ –∑–∞–¥–∞—á –¥–æ–±—Ä–µ –ø—ñ–¥—Ö–æ–¥—è—Ç—å –¥–ª—è –º–æ–¥–µ–ª—ñ MapReduce?
- –Ø–∫ –º–æ–∂–Ω–∞ –ø–æ–∫—Ä–∞—â–∏—Ç–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å "shuffle and sort"?
- –Ø–∫ —Ü—è –º–æ–¥–µ–ª—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —É —Å—É—á–∞—Å–Ω–∏—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Spark, Flink)?

**–î–æ–º–∞—à–Ω—î –∑–∞–≤–¥–∞–Ω–Ω—è (–¢–µ–æ—Ä–µ—Ç–∏—á–Ω–µ –ø–∏—Ç–∞–Ω–Ω—è):**

- –î–æ–≤–µ–¥—ñ—Ç—å, —á–æ–º—É MapReduce –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω–æ –Ω–∞–≤—ñ—Ç—å –¥–ª—è –º—ñ–ª—å—è—Ä–¥—ñ–≤ –∑–∞–ø–∏—Å—ñ–≤.
- –Ø–∫ "combiner" –º–æ–∂–µ –∑–º–µ–Ω—à–∏—Ç–∏ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ —Ä–µ–¥—å—é—Å–µ—Ä–∏?

**–î–æ–º–∞—à–Ω—î –∑–∞–≤–¥–∞–Ω–Ω—è (–ü—Ä–∞–∫—Ç–∏—á–Ω–µ –∑–∞–≤–¥–∞–Ω–Ω—è):**

- –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ MapReduce –¥–ª—è –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—ñ –ø—Ä–æ–¥—É–∫—Ç—ñ–≤ —É –¥–∞–Ω–∏—Ö –ø—Ä–æ–¥–∞–∂—ñ–≤ (—Ñ–æ—Ä–º–∞—Ç: `product_id, quantity`).
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ Hadoop (–∞–±–æ PySpark) –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –≤–µ–ª–∏–∫–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤–∏—Ö —Ñ–∞–π–ª—ñ–≤.

# MapReduce: Way Out

\#distributed-computing \#big-data \#mapreduce \#parallel-processing

## –¢–µ–æ—Ä–µ—Ç–∏—á–Ω–∏–π –±–ª–æ–∫

### –ß–æ–º—É –æ–±—Ä–æ–±–∫–∞ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è —î –≤–∞–∂–ª–∏–≤–æ—é –¥–ª—è —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏—Ö —Å–∏—Å—Ç–µ–º?

\#key-value \#distributed-systems

**–†–æ–∑'—è—Å–Ω–µ–Ω–Ω—è:** –û–±—Ä–æ–±–∫–∞ —É —Ñ–æ—Ä–º–∞—Ç—ñ "–∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è" –¥–æ–∑–≤–æ–ª—è—î:

1.  **–†–æ–∑–ø–æ–¥—ñ–ª–∏—Ç–∏ –¥–∞–Ω—ñ:** –ö–ª—é—á—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è —à–∞—Ä–¥—ñ–Ω–≥—É –¥–∞–Ω–∏—Ö –º—ñ–∂ –≤—É–∑–ª–∞–º–∏, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ –ø–∞—Ä–∞–ª–µ–ª—å–Ω—É –æ–±—Ä–æ–±–∫—É
2.  **–ê–≥—Ä–µ–≥–∞—Ü—ñ—é –¥–∞–Ω–∏—Ö:** –ó–≥—Ä—É–ø–æ–≤–∞–Ω—ñ –∑–∞ –∫–ª—é—á–∞–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è –Ω–µ–∑–∞–ª–µ–∂–Ω–æ, —â–æ –º—ñ–Ω—ñ–º—ñ–∑—É—î –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –º—ñ–∂ –≤—É–∑–ª–∞–º–∏
3.  **–ü—Ä–æ—Å—Ç–æ—Ç—É —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó:** –§–æ—Ä–º–∞—Ç –∑–∞–±–µ–∑–ø–µ—á—É—î –º–æ–¥—É–ª—å–Ω—ñ—Å—Ç—å —Ç–∞ —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω—ñ—Å—Ç—å –æ–±—Ä–æ–±–∫–∏ –¥–∞–Ω–∏—Ö —É –±–∞–≥–∞—Ç—å–æ—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—è—Ö

**–†–µ–∞–ª—å–Ω–µ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è:**
- –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—ñ –ø—Ä–æ–¥—É–∫—Ç—ñ–≤ –∑–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º–∏
- –ê–≥—Ä–µ–≥–∞—Ü—ñ—è –ª–æ–≥—ñ–≤ –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –º–µ—Ä–µ–∂–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ—ñ–∫—É

**–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó:**
- **Hadoop:** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î "–∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è" –¥–ª—è –ø–æ–¥—ñ–ª—É –∑–∞–¥–∞—á –º—ñ–∂ –º–∞–ø–ø–µ—Ä–∞–º–∏ —Ç–∞ —Ä–µ–¥—å—é—Å–µ—Ä–∞–º–∏
- **Cassandra:** –ü–æ–±—É–¥–æ–≤–∞–Ω–∞ –Ω–∞ –º–æ–¥–µ–ª—ñ "–∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è" –¥–ª—è —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–æ–≥–æ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö

### –Ø–∫ "shuffle and sort" –≤–ø–ª–∏–≤–∞—î –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å MapReduce?

\#performance \#optimization

**–†–æ–∑'—è—Å–Ω–µ–Ω–Ω—è:** –ü—Ä–æ—Ü–µ—Å "shuffle and sort":

1.  **–†–æ–∑–ø–æ–¥—ñ–ª—è—î –¥–∞–Ω—ñ:** –ü–µ—Ä–µ–Ω–æ—Å–∏—Ç—å –¥–∞–Ω—ñ –º—ñ–∂ –º–∞–ø–ø–µ—Ä–∞–º–∏ —ñ —Ä–µ–¥—å—é—Å–µ—Ä–∞–º–∏, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ –∞–≥—Ä–µ–≥–∞—Ü—ñ—é –¥–∞–Ω–∏—Ö –∑ –æ–¥–Ω–∞–∫–æ–≤–∏–º–∏ –∫–ª—é—á–∞–º–∏
2.  **–û–ø—Ç–∏–º—ñ–∑—É—î –æ–±—á–∏—Å–ª–µ–Ω–Ω—è:** –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –¥–æ–∑–≤–æ–ª—è—î —Ä–µ–¥—å—é—Å–µ—Ä–∞–º –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–∏–º–∏ –∫–ª—é—á–∞–º–∏
3.  **–í–ø–ª–∏–≤–∞—î –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å:** –¶–µ –Ω–∞–π–¥–æ–≤—à–∞ —Å—Ç–∞–¥—ñ—è —á–µ—Ä–µ–∑ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ—Å—Ç—å –ø–µ—Ä–µ—Å–∏–ª–∞–Ω–Ω—è –≤–µ–ª–∏–∫–∏—Ö –æ–±—Å—è–≥—ñ–≤ –¥–∞–Ω–∏—Ö

**–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó:**
- **Apache Tez:** –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ MapReduce –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó "shuffle and sort"
- **Spark:** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø–∞–º'—è—Ç—å –¥–ª—è –∑–º–µ–Ω—à–µ–Ω–Ω—è –≤–∏—Ç—Ä–∞—Ç –Ω–∞ —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è

## –ü—Ä–∞–∫—Ç–∏—á–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è

### –ë–∞–∑–æ–≤–∏–π –ø—Ä–∏–∫–ª–∞–¥ MapReduce –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –ø—Ä–æ–¥–∞–∂—ñ–≤

``` python
from typing import List, Tuple, Dict
from collections import defaultdict

def map_sales(data: List[str]) -> List[Tuple[str, int]]:
    """
    Map —Ñ—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –¥–∞–Ω–∏—Ö –ø—Ä–æ–¥–∞–∂—ñ–≤.
    
    Args:
        data: –°–ø–∏—Å–æ–∫ —Ä—è–¥–∫—ñ–≤ –∑ –¥–∞–Ω–∏–º–∏ –ø—Ä–æ–¥–∞–∂—ñ–≤ —É —Ñ–æ—Ä–º–∞—Ç—ñ "product,quantity"
        
    Returns:
        List[Tuple[str, int]]: –°–ø–∏—Å–æ–∫ –ø–∞—Ä (–ø—Ä–æ–¥—É–∫—Ç, –∫—ñ–ª—å–∫—ñ—Å—Ç—å)
    """
    intermediate = []
    for entry in data:
        product, quantity = entry.split(",")
        intermediate.append((product, int(quantity)))
    return intermediate

def reduce_sales(intermediate: List[Tuple[str, int]]) -> Dict[str, int]:
    """
    Reduce —Ñ—É–Ω–∫—Ü—ñ—è –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü—ñ—ó –ø—Ä–æ–¥–∞–∂—ñ–≤.
    
    Args:
        intermediate: –°–ø–∏—Å–æ–∫ –ø–∞—Ä (–ø—Ä–æ–¥—É–∫—Ç, –∫—ñ–ª—å–∫—ñ—Å—Ç—å)
    
    Returns:
        Dict[str, int]: –°–ª–æ–≤–Ω–∏–∫ –∑ –∑–∞–≥–∞–ª—å–Ω–æ—é –∫—ñ–ª—å–∫—ñ—Å—Ç—é –ø—Ä–æ–¥–∞–∂—ñ–≤ –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞—Ö
    """
    result = defaultdict(int)
    for product, quantity in intermediate:
        result[product] += quantity
    return dict(result)

# –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
sales_data = [
    "product1,2",
    "product2,3",
    "product1,5",
    "product3,7",
    "product2,1"
]

mapped_sales = map_sales(sales_data)
reduced_sales = reduce_sales(mapped_sales)

print("–ü—Ä–æ–¥–∞–∂—ñ –ø—Ä–æ–¥—É–∫—Ç—ñ–≤:")
for product, total in reduced_sales.items():
    print(f"{product}: {total}")
```

### –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è —É PySpark –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö

``` python
from pyspark.sql import SparkSession
from typing import List, Tuple

def process_large_file(input_path: str, output_path: str) -> None:
    """
    –û–±—Ä–æ–±–ª—è—î –≤–µ–ª–∏–∫–∏–π —Ç–µ–∫—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ PySpark.
    
    Args:
        input_path: –®–ª—è—Ö –¥–æ –≤—Ö—ñ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        output_path: –®–ª—è—Ö –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
    """
    spark = SparkSession.builder \
        .appName("WordCount") \
        .getOrCreate()

    # –ß–∏—Ç–∞—î–º–æ —Ñ–∞–π–ª
    text_file = spark.sparkContext.textFile(input_path)

    # MapReduce –æ–ø–µ—Ä–∞—Ü—ñ—ó
    word_counts = text_file \
        .flatMap(lambda line: line.split()) \
        .map(lambda word: (word, 1)) \
        .reduceByKey(lambda a, b: a + b)

    # –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    word_counts.saveAsTextFile(output_path)
    
    spark.stop()
```

## –†–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∞ –æ–±—Ä–æ–±–∫–∞ —Ç–∞ –≤—ñ–¥–º–æ–≤–æ—Å—Ç—ñ–π–∫—ñ—Å—Ç—å

### –ú–µ—Ö–∞–Ω—ñ–∑–º–∏ –æ–±—Ä–æ–±–∫–∏ –Ω–µ–≤–¥–∞–ª–∏—Ö –∑–∞–¥–∞—á

\#fault-tolerance \#reliability

1.  **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—è:**
    - –ó–∞–¥–∞—á—ñ –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–∞—é—Ç—å—Å—è –Ω–∞ —ñ–Ω—à—ñ –≤—É–∑–ª–∏ –ø—Ä–∏ –≤—ñ–¥–º–æ–≤—ñ
    - HDFS –∑–∞–±–µ–∑–ø–µ—á—É—î –Ω–∞–¥—ñ–π–Ω–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –ø—Ä–æ–º—ñ–∂–Ω–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
2.  **–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞–Ω—É:**
    - JobTracker (Hadoop 1) –∞–±–æ ResourceManager (Hadoop 2)
    - –ü–æ—Å—Ç—ñ–π–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤'—è –≤—É–∑–ª—ñ–≤ –∫–ª–∞—Å—Ç–µ—Ä–∞

### –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

\#performance-optimization

1.  **–ö–æ–º–±—ñ–Ω–µ—Ä–∏ (Combiners):**
    - –õ–æ–∫–∞–ª—å–Ω–∞ –∞–≥—Ä–µ–≥–∞—Ü—ñ—è –Ω–∞ –≤—É–∑–ª–∞—Ö –º–∞–ø–ø–µ—Ä—ñ–≤
    - –ó–º–µ–Ω—à–µ–Ω–Ω—è –º–µ—Ä–µ–∂–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ—ñ–∫—É
2.  **–ü–∞—Ä—Ç–∏—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö:**
    - –û–ø—Ç–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª –∫–ª—é—á—ñ–≤ –º—ñ–∂ —Ä–µ–¥—å—é—Å–µ—Ä–∞–º–∏
    - –£–Ω–∏–∫–Ω–µ–Ω–Ω—è –¥–∏—Å–±–∞–ª–∞–Ω—Å—É –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

## –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑ —Å—É—á–∞—Å–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

### MapReduce vs Spark

\#comparison \#modern-systems

**MapReduce –ø–µ—Ä–µ–≤–∞–≥–∏:**
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ –º–æ–¥–µ–ª—ñ
- –ù–∞–¥—ñ–π–Ω—ñ—Å—Ç—å –¥–ª—è batch-–æ–±—Ä–æ–±–∫–∏
- –í–∏—Å–æ–∫–∞ –≤—ñ–¥–º–æ–≤–æ—Å—Ç—ñ–π–∫—ñ—Å—Ç—å

**Spark –ø–µ—Ä–µ–≤–∞–≥–∏:**
- –û–±—Ä–æ–±–∫–∞ –≤ –ø–∞–º'—è—Ç—ñ
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ —Å—Ç—Ä—ñ–º—ñ–Ω–≥—É
- –ë–∞–≥–∞—Ç—à–∏–π API

## –ü—ñ–¥—Å—É–º–æ–∫

MapReduce –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ—é –º–æ–¥–µ–ª–ª—é –¥–ª—è —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å, –æ—Å–æ–±–ª–∏–≤–æ –¥–ª—è:
1. –û–±—Ä–æ–±–∫–∏ –≤–µ–ª–∏–∫–∏—Ö –æ–±—Å—è–≥—ñ–≤ –¥–∞–Ω–∏—Ö
2. ETL-–ø—Ä–æ—Ü–µ—Å—ñ–≤
3. –ê–Ω–∞–ª—ñ—Ç–∏—á–Ω–∏—Ö –∑–∞–¥–∞—á

\#mapreduce \#hadoop \#spark \#distributed-computing \#big-data \#data-engineering
